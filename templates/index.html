<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- Primary Meta Tags -->
    <title>go.travel - AI Travel Itinerary Generator | Smart Trip Planning</title>
    <meta name="title" content="go.travel - AI Travel Itinerary Generator | Smart Trip Planning">
    <meta name="description" content="Create personalized travel itineraries in seconds with AI-powered trip planning. Get weather forecasts, local attractions, restaurant recommendations, and smart travel tips for any destination worldwide.">
    <meta name="keywords" content="travel planner, AI travel, itinerary generator, trip planning, travel guide, vacation planner, travel recommendations, smart travel, travel assistant">
    <meta name="author" content="go.travel">
    <meta name="robots" content="index, follow">
    <meta name="language" content="English">
    <meta name="revisit-after" content="7 days">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://gotravel-cac.github.io/">
    <meta property="og:title" content="go.travel - AI Travel Itinerary Generator">
    <meta property="og:description" content="Create personalized travel itineraries in seconds with AI-powered trip planning. Get weather forecasts, local attractions, and smart travel tips.">
    <meta property="og:image" content="https://gotravel-cac.github.io/gotravel.png">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:site_name" content="go.travel">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://gotravel-cac.github.io/">
    <meta property="twitter:title" content="go.travel - AI Travel Itinerary Generator">
    <meta property="twitter:description" content="Create personalized travel itineraries in seconds with AI-powered trip planning. Get weather forecasts, local attractions, and smart travel tips.">
    <meta property="twitter:image" content="https://gotravel-cac.github.io/gotravel.png">
    
    <!-- Additional Meta Tags -->
    <meta name="theme-color" content="#1e40af">
    <meta name="msapplication-TileColor" content="#1e40af">
    <meta name="msapplication-config" content="/favicon/browserconfig.xml">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="go.travel">
    
    <!-- Favicon and Icons -->
    <link rel="icon" type="image/x-icon" href="favicon/favicon.ico">
    <link rel="icon" type="image/svg+xml" href="favicon/favicon.svg">
    <link rel="apple-touch-icon" href="favicon/apple-touch-icon.png">
    <link rel="manifest" href="favicon/site.webmanifest">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;500;600;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Google Maps JavaScript API -->
    <script async defer src="https://maps.googleapis.com/maps/api/js?key={{ google_api_key }}&libraries=places&callback=initMaps"></script>
    
    <!-- Structured Data -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "go.travel",
      "description": "AI-powered travel itinerary generator for smart trip planning",
      "url": "https://gotravel-cac.github.io/",
      "applicationCategory": "Travel",
      "operatingSystem": "All",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
      },
      "author": {
        "@type": "Organization",
        "name": "go.travel"
      }
    }
    </script>
    <style>
        :root {
            --primary-blue: #1e40af;
            --primary-green: #059669;
            --gradient-bg: linear-gradient(135deg, #1e40af 0%, #059669 100%);
            --text-dark: #1f2937;
            --text-light: #6b7280;
            --text-white: #ffffff;
            --bg-light: #f8fafc;
            --bg-white: #ffffff;
            --border-light: #e5e7eb;
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1);
            --rounded-lg: 0.5rem;
            --rounded-xl: 0.75rem;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: var(--text-dark);
            background: var(--bg-light);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1rem;
        }

        /* Header */
        .header {
            background: var(--gradient-bg);
            color: var(--text-white);
            padding: 3rem 0;
            text-align: center;
            box-shadow: var(--shadow-lg);
        }

        .header h1 {
            font-family: 'Dancing Script', cursive;
            font-size: 4rem;
            font-weight: 700;
            margin-bottom: 1rem;
            letter-spacing: -0.02em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        .header p {
            font-size: 1.25rem;
            opacity: 0.9;
            max-width: 600px;
            margin: 0 auto 2rem auto;
        }

        /* Travel Stats */
        .travel-stats {
            display: flex;
            justify-content: center;
            gap: 3rem;
            margin-top: 2rem;
            flex-wrap: wrap;
        }

        .stat-item {
            text-align: center;
        }

        .stat-number {
            font-family: 'Dancing Script', cursive;
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--text-white);
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .stat-label {
            font-size: 0.9rem;
            opacity: 0.8;
            margin-top: 0.25rem;
        }

        /* Main Content */
        .main-content {
            padding: 4rem 0;
        }

        .trip-form {
            background: var(--bg-white);
            border-radius: var(--rounded-xl);
            box-shadow: var(--shadow-lg);
            padding: 2rem;
            margin-bottom: 2rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            font-family: 'Dancing Script', cursive;
            display: block;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--text-dark);
            font-size: 1.2rem;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 1px solid var(--border-light);
            border-radius: var(--rounded-lg);
            font-size: 1rem;
            transition: border-color 0.2s, box-shadow 0.2s;
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: var(--primary-blue);
            box-shadow: 0 0 0 3px rgb(30 64 175 / 0.1);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        .interests-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 0.5rem;
            margin-top: 0.5rem;
        }

        .interest-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .interest-item input[type="checkbox"] {
            width: auto;
        }

        .generate-btn {
            font-family: 'Dancing Script', cursive;
            background: var(--gradient-bg);
            color: var(--text-white);
            border: none;
            padding: 1rem 2rem;
            font-size: 1.3rem;
            font-weight: 600;
            border-radius: var(--rounded-lg);
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            width: 100%;
            letter-spacing: 0.02em;
        }

        .generate-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .generate-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        /* Status Display */
        .status-display {
            background: var(--bg-white);
            border-radius: var(--rounded-xl);
            box-shadow: var(--shadow-md);
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        .status-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0.5rem 0;
            border-bottom: 1px solid var(--border-light);
        }

        .status-item:last-child {
            border-bottom: none;
        }

        .status-label {
            font-weight: 500;
        }

        .status-value {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .status-online {
            color: var(--primary-green);
            font-weight: 600;
        }

        .status-warning {
            color: #f59e0b;
            font-weight: 600;
        }

        .status-offline {
            color: #dc2626;
            font-weight: 600;
        }

        /* Location Preview Styles */
        .location-preview {
            background: linear-gradient(135deg, #f0f9ff 0%, #ecfdf5 100%);
            border: 2px solid var(--primary-blue);
            border-radius: var(--rounded-xl);
            padding: 1.5rem;
            margin: 1.5rem 0;
        }

        .location-info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .location-card {
            background: var(--bg-white);
            padding: 1rem;
            border-radius: var(--rounded-lg);
            box-shadow: var(--shadow-sm);
            border-left: 4px solid var(--primary-green);
        }

        .location-card h5 {
            font-family: 'Dancing Script', cursive;
            font-size: 1.2rem;
            margin-bottom: 0.5rem;
            color: var(--primary-blue);
        }

        .location-map {
            background: var(--bg-white);
            padding: 1rem;
            border-radius: var(--rounded-lg);
            box-shadow: var(--shadow-sm);
        }

        .location-map h5 {
            font-family: 'Dancing Script', cursive;
            font-size: 1.2rem;
            margin-bottom: 1rem;
            color: var(--primary-blue);
        }

        /* Trip Overview Styles */
        .trip-overview {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            border: 2px solid var(--primary-green);
            border-radius: var(--rounded-xl);
            padding: 1.5rem;
            margin: 1.5rem 0;
        }

        .overview-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1rem;
        }

        .overview-card {
            background: var(--bg-white);
            padding: 1.25rem;
            border-radius: var(--rounded-lg);
            box-shadow: var(--shadow-md);
            border-left: 4px solid var(--primary-blue);
        }

        .overview-card h4 {
            font-family: 'Dancing Script', cursive;
            font-size: 1.3rem;
            margin-bottom: 0.75rem;
            color: var(--primary-green);
        }

        /* Inspiration Section Styles */
        .inspiration-section {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            border-radius: var(--rounded-xl);
            padding: 2.5rem;
            margin: 3rem 0;
            box-shadow: var(--shadow-lg);
        }

        .destination-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
        }

        .destination-card {
            background: var(--bg-white);
            border-radius: var(--rounded-xl);
            padding: 1.5rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            box-shadow: var(--shadow-sm);
        }

        .destination-card:hover {
            transform: translateY(-5px);
            border-color: var(--primary-blue);
            box-shadow: var(--shadow-lg);
        }

        .destination-emoji {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .destination-card h4 {
            font-family: 'Dancing Script', cursive;
            font-size: 1.4rem;
            margin-bottom: 0.5rem;
            color: var(--primary-blue);
        }

        .destination-card p {
            color: var(--text-light);
            font-size: 0.9rem;
        }

        /* Features Section Styles */
        .features-section {
            background: linear-gradient(135deg, #f0fdf4 0%, #ecfdf5 100%);
            border-radius: var(--rounded-xl);
            padding: 2.5rem;
            margin: 3rem 0;
            box-shadow: var(--shadow-lg);
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
        }

        .feature-card {
            background: var(--bg-white);
            border-radius: var(--rounded-lg);
            padding: 1.5rem;
            border-left: 4px solid var(--primary-green);
            box-shadow: var(--shadow-sm);
            transition: all 0.3s ease;
        }

        .feature-card:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-md);
        }

        .feature-icon {
            font-size: 2.5rem;
            margin-bottom: 1rem;
        }

        .feature-card h4 {
            font-family: 'Dancing Script', cursive;
            font-size: 1.3rem;
            margin-bottom: 0.75rem;
            color: var(--primary-blue);
        }

        .feature-card p {
            color: var(--text-light);
            line-height: 1.5;
        }

        /* Recent Searches Styles */
        .destination-input-container {
            position: relative;
        }

        .recent-searches {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: var(--bg-white);
            border: 1px solid var(--border-light);
            border-radius: var(--rounded-lg);
            box-shadow: var(--shadow-lg);
            z-index: 1000;
            max-height: 200px;
            overflow-y: auto;
        }

        .recent-searches-header {
            padding: 0.75rem 1rem;
            background: var(--bg-light);
            font-weight: 600;
            font-size: 0.85rem;
            color: var(--text-light);
            border-bottom: 1px solid var(--border-light);
        }

        .recent-search-item {
            padding: 0.75rem 1rem;
            cursor: pointer;
            transition: background-color 0.2s;
            border-bottom: 1px solid var(--border-light);
        }

        .recent-search-item:hover {
            background: var(--bg-light);
        }

        .recent-search-item:last-child {
            border-bottom: none;
        }

        .clear-searches {
            padding: 0.5rem 1rem;
            text-align: center;
            font-size: 0.8rem;
            color: var(--text-light);
            cursor: pointer;
            border-top: 1px solid var(--border-light);
        }

        .clear-searches:hover {
            background: var(--bg-light);
            color: var(--primary-blue);
        }

        /* Results Display */
        .results-section {
            background: var(--bg-white);
            border-radius: var(--rounded-xl);
            box-shadow: var(--shadow-lg);
            padding: 2rem;
            margin-top: 2rem;
            display: none;
        }

        .results-section.show {
            display: block;
        }

        .results-header {
            border-bottom: 2px solid var(--border-light);
            padding-bottom: 1rem;
            margin-bottom: 2rem;
        }

        .results-header h2 {
            color: var(--text-dark);
            font-size: 1.75rem;
            margin-bottom: 0.5rem;
        }

        .trip-summary {
            color: var(--text-light);
            font-size: 1rem;
        }

        .itinerary-content {
            line-height: 1.8;
            color: var(--text-dark);
        }

        .itinerary-content h3 {
            color: var(--primary-blue);
            margin: 1.5rem 0 1rem 0;
            font-size: 1.25rem;
        }

        .itinerary-content ul {
            margin: 1rem 0;
            padding-left: 1.5rem;
        }

        .itinerary-content li {
            margin: 0.5rem 0;
        }

        /* Loading Animation */
        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1rem;
            padding: 2rem;
        }

        .spinner {
            width: 32px;
            height: 32px;
            border: 3px solid var(--border-light);
            border-top: 3px solid var(--primary-blue);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Error Display */
        .error-message {
            background: #fef2f2;
            border: 1px solid #fecaca;
            color: #dc2626;
            padding: 1rem;
            border-radius: var(--rounded-lg);
            margin: 1rem 0;
        }

        /* Success Display */
        .success-message {
            background: #f0fdf4;
            border: 1px solid #bbf7d0;
            color: var(--primary-green);
            padding: 1rem;
            border-radius: var(--rounded-lg);
            margin: 1rem 0;
        }

        /* Footer */
        .footer {
            background: var(--text-dark);
            color: var(--text-white);
            padding: 3rem 0 1rem 0;
            margin-top: 4rem;
        }

        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .footer-section h4 {
            font-family: 'Dancing Script', cursive;
            font-size: 1.5rem;
            margin-bottom: 1rem;
            color: var(--primary-green);
        }

        .footer-section ul {
            list-style: none;
            padding: 0;
        }

        .footer-section li {
            margin: 0.5rem 0;
            opacity: 0.8;
        }

        .footer-bottom {
            text-align: center;
            padding-top: 2rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            opacity: 0.7;
        }

        .social-links {
            margin-top: 1rem;
            opacity: 0.8;
        }

        /* Floating Action Button */
        .fab {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            width: 60px;
            height: 60px;
            background: var(--gradient-bg);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: var(--shadow-lg);
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .fab:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 25px rgba(30, 64, 175, 0.3);
        }

        /* Itinerary Management Styles */
        .itinerary-management {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            border: 2px solid var(--primary-green);
            border-radius: var(--rounded-xl);
            padding: 1.5rem;
            margin: 2rem 0;
        }

        .management-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
        }

        .management-card {
            background: var(--bg-white);
            padding: 1.5rem;
            border-radius: var(--rounded-lg);
            box-shadow: var(--shadow-md);
        }

        .management-card h4 {
            font-family: 'Dancing Script', cursive;
            font-size: 1.3rem;
            margin-bottom: 1rem;
            color: var(--primary-blue);
        }

        .management-card textarea {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid var(--border-light);
            border-radius: var(--rounded-lg);
            margin-bottom: 1rem;
            resize: vertical;
        }

        .action-btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: var(--rounded-lg);
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s;
            margin: 0.25rem;
        }

        .action-btn.primary {
            background: var(--gradient-bg);
            color: var(--text-white);
            width: 100%;
        }

        .action-btn.secondary {
            background: var(--bg-light);
            color: var(--text-dark);
            border: 1px solid var(--border-light);
        }

        .action-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.5rem;
        }

        @media (max-width: 768px) {
            .management-grid {
                grid-template-columns: 1fr;
            }
            
            .action-buttons {
                grid-template-columns: 1fr;
            }
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }

            .header p {
                font-size: 1rem;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .interests-grid {
                grid-template-columns: 1fr;
            }

            .container {
                padding: 0 0.5rem;
            }

            .trip-form {
                padding: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <h1>go.travel</h1>
            <p>AI-Powered Travel Itinerary Generator - Create personalized travel plans in seconds</p>
            
            <!-- Key Features -->
            <div class="travel-stats">
                <div class="stat-item">
                    <div class="stat-number">🤖</div>
                    <div class="stat-label">AI-Powered</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number">🗺️</div>
                    <div class="stat-label">Interactive Maps</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number">⚡</div>
                    <div class="stat-label">Instant Results</div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
        <div class="container">
            <!-- API Status -->
            <div class="status-display">
                <h3 style="margin-bottom: 1rem;">🔧 System Status</h3>
                <div class="status-item">
                    <span class="status-label">Backend API</span>
                    <span class="status-value">
                        <span id="backend-status" class="status-offline">Checking...</span>
                    </span>
                </div>
                <div class="status-item">
                    <span class="status-label">Gemini AI</span>
                    <span class="status-value">
                        <span id="ai-status" class="status-offline">Checking...</span>
                    </span>
                </div>
            </div>

            <!-- Travel Inspiration Section -->
            <div class="inspiration-section">
                <h3 style="font-family: 'Dancing Script', cursive; font-size: 2.2rem; text-align: center; margin-bottom: 2rem; color: var(--primary-blue);">✨ Popular Destinations</h3>
                <div class="destination-grid" id="destination-grid">
                    <div class="loading-destinations">
                        <div class="spinner"></div>
                        <span>Loading popular destinations...</span>
                    </div>
                </div>
            </div>

            <!-- Quick Features Section -->
            <div class="features-section">
                <h3 style="font-family: 'Dancing Script', cursive; font-size: 2.2rem; text-align: center; margin-bottom: 2rem; color: var(--primary-green);">🚀 Smart Features</h3>
                <div class="features-grid">
                    <div class="feature-card">
                        <div class="feature-icon">🤖</div>
                        <h4>AI-Powered Planning</h4>
                        <p>Advanced Gemini AI creates personalized itineraries based on your preferences and interests</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">🌤️</div>
                        <h4>Real-Time Weather</h4>
                        <p>Get current weather conditions and forecasts to plan your activities perfectly</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">📍</div>
                        <h4>Local Insights</h4>
                        <p>Discover top-rated attractions, restaurants, and hidden gems with live data from Google</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">🗺️</div>
                        <h4>Interactive Maps</h4>
                        <p>Visualize your destinations with detailed maps and location previews</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">💰</div>
                        <h4>Budget Planning</h4>
                        <p>Customize your trip based on budget preferences from budget-friendly to luxury</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">⚡</div>
                        <h4>Instant Results</h4>
                        <p>Generate comprehensive travel plans in seconds, not hours</p>
                    </div>
                </div>
            </div>

            <!-- Trip Planning Form -->
            <form class="trip-form" id="tripForm">
                <h2 style="margin-bottom: 1.5rem; color: var(--text-dark);">✈️ Plan Your Dream Trip</h2>
                
                <div class="form-group">
                    <label for="destination">Destination</label>
                    <div class="destination-input-container">
                        <input type="text" id="destination" name="destination" placeholder="Start typing a destination..." required autocomplete="off">
                        <div id="recent-searches" class="recent-searches" style="display: none;">
                            <div class="recent-searches-header">Recent Searches</div>
                            <div id="recent-searches-list"></div>
                        </div>
                    </div>
                </div>

                <!-- Location Preview Section -->
                <div id="location-preview" class="location-preview" style="display: none;">
                    <h4 style="font-family: 'Dancing Script', cursive; font-size: 1.3rem; margin-bottom: 1rem; color: var(--primary-blue);">📍 Location Preview</h4>
                    <div class="location-info-grid">
                        <div class="location-card">
                            <h5>🌍 Basic Info</h5>
                            <div id="location-basic">Loading...</div>
                        </div>
                        <div class="location-card">
                            <h5>🌤️ Current Weather</h5>
                            <div id="location-weather">Loading...</div>
                        </div>
                        <div class="location-card">
                            <h5>🕒 Local Time</h5>
                            <div id="location-time">Loading...</div>
                        </div>
                        <div class="location-card">
                            <h5>🎯 Top Attractions</h5>
                            <div id="location-attractions">Loading...</div>
                        </div>
                        <div class="location-card">
                            <h5>🍽️ Top Restaurants</h5>
                            <div id="location-restaurants">Loading...</div>
                        </div>
                    </div>
                    <div class="location-map">
                        <h5>🗺️ Location Map</h5>
                        <div id="location-map-container">
                            <div id="location-map" style="width: 100%; height: 300px; border-radius: 8px;"></div>
                        </div>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="startDate">Start Date</label>
                        <input type="date" id="startDate" name="startDate" required>
                    </div>
                    <div class="form-group">
                        <label for="endDate">End Date</label>
                        <input type="date" id="endDate" name="endDate" required>
                    </div>
                </div>

                <div class="form-group">
                    <label for="duration">Trip Duration</label>
                    <select id="duration" name="duration" required>
                        <option value="">Select duration</option>
                        <option value="1">1 day</option>
                        <option value="2">2 days</option>
                        <option value="3">3 days</option>
                        <option value="4">4 days</option>
                        <option value="5">5 days</option>
                        <option value="6">6 days</option>
                        <option value="7">1 week</option>
                        <option value="10">10 days</option>
                        <option value="14">2 weeks</option>
                        <option value="21">3 weeks</option>
                        <option value="30">1 month</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="budget">Budget Range (Optional)</label>
                    <select id="budget" name="budget">
                        <option value="">Select budget range</option>
                        <option value="budget">Budget ($50-100/day)</option>
                        <option value="mid-range">Mid-range ($100-300/day)</option>
                        <option value="luxury">Luxury ($300+/day)</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Travel Interests (Select all that apply)</label>
                    <div class="interests-grid">
                        <div class="interest-item">
                            <input type="checkbox" id="culture" name="interests" value="culture">
                            <label for="culture">Culture & History</label>
                        </div>
                        <div class="interest-item">
                            <input type="checkbox" id="food" name="interests" value="food">
                            <label for="food">Food & Cuisine</label>
                        </div>
                        <div class="interest-item">
                            <input type="checkbox" id="adventure" name="interests" value="adventure">
                            <label for="adventure">Adventure & Sports</label>
                        </div>
                        <div class="interest-item">
                            <input type="checkbox" id="nature" name="interests" value="nature">
                            <label for="nature">Nature & Wildlife</label>
                        </div>
                        <div class="interest-item">
                            <input type="checkbox" id="art" name="interests" value="art">
                            <label for="art">Art & Museums</label>
                        </div>
                        <div class="interest-item">
                            <input type="checkbox" id="nightlife" name="interests" value="nightlife">
                            <label for="nightlife">Nightlife & Entertainment</label>
                        </div>
                        <div class="interest-item">
                            <input type="checkbox" id="shopping" name="interests" value="shopping">
                            <label for="shopping">Shopping</label>
                        </div>
                        <div class="interest-item">
                            <input type="checkbox" id="relaxation" name="interests" value="relaxation">
                            <label for="relaxation">Relaxation & Wellness</label>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label for="special-requests">Special Requests (Optional)</label>
                    <textarea id="special-requests" name="specialRequests" rows="3" 
                              placeholder="Any specific preferences, dietary restrictions, accessibility needs, or special occasions?"></textarea>
                </div>

                <button type="submit" class="generate-btn" id="generateBtn">
                    🚀 Generate My Itinerary
                </button>
            </form>

            <!-- Results Section -->
            <div class="results-section" id="resultsSection">
                <div class="results-header">
                    <h2>Your Personalized Itinerary</h2>
                    <p class="trip-summary" id="tripSummary"></p>
                </div>
                
                <!-- Enhanced Trip Overview -->
                <div id="trip-overview" class="trip-overview" style="display: none;">
                    <h3 style="font-family: 'Dancing Script', cursive; font-size: 1.8rem; color: var(--primary-blue); margin-bottom: 1rem;">🎯 Trip Overview & Recommendations</h3>
                    <div class="overview-grid">
                        <div class="overview-card">
                            <h4>🗺️ Location Details</h4>
                            <div id="overview-location">Loading...</div>
                        </div>
                        <div class="overview-card">
                            <h4>🌤️ Weather Forecast</h4>
                            <div id="overview-weather">Loading...</div>
                        </div>
                        <div class="overview-card">
                            <h4>🚗 Getting Around</h4>
                            <div id="overview-transport">Loading...</div>
                        </div>
                        <div class="overview-card">
                            <h4>💡 Local Tips</h4>
                            <div id="overview-tips">Loading...</div>
                        </div>
                    </div>
                </div>
                
                <div class="itinerary-content" id="itineraryContent"></div>
                
                <!-- Itinerary Management Section -->
                <div id="itinerary-management" class="itinerary-management" style="display: none;">
                    <h3 style="font-family: 'Dancing Script', cursive; font-size: 1.8rem; color: var(--primary-blue); margin-bottom: 1rem;">✏️ Customize Your Itinerary</h3>
                    
                    <div class="management-grid">
                        <div class="management-card">
                            <h4>📝 Request Changes</h4>
                            <textarea id="itinerary-changes" placeholder="What would you like to change? (e.g., add more restaurants, remove outdoor activities, focus on museums)" rows="3"></textarea>
                            <button onclick="refineItinerary()" class="action-btn primary">Update Itinerary</button>
                        </div>
                        
                        <div class="management-card">
                            <h4>📤 Share & Save</h4>
                            <div class="action-buttons">
                                <button onclick="shareItinerary()" class="action-btn secondary">🔗 Share Link</button>
                                <button onclick="downloadPDF()" class="action-btn secondary">📄 Download PDF</button>
                                <button onclick="downloadText()" class="action-btn secondary">📝 Download Text</button>
                                <button onclick="emailItinerary()" class="action-btn secondary">📧 Email</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h4>go.travel</h4>
                    <p>AI-powered travel planning made simple. Create your perfect itinerary in seconds.</p>
                    <div class="social-links">
                        <span>🌐 Connect with us</span>
                    </div>
                </div>
                <div class="footer-section">
                    <h4>Features</h4>
                    <ul>
                        <li>🤖 AI Itinerary Generation</li>
                        <li>🌤️ Real-time Weather</li>
                        <li>📍 Local Recommendations</li>
                        <li>🗺️ Interactive Maps</li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>Popular Destinations</h4>
                    <ul>
                        <li>🗼 Paris, France</li>
                        <li>🏯 Tokyo, Japan</li>
                        <li>🗽 New York, USA</li>
                        <li>🏰 London, England</li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>Features</h4>
                    <ul>
                        <li>🤖 AI-Powered Planning</li>
                        <li>�️ Interactive Maps</li>
                        <li>🌐 Real-time Weather</li>
                        <li>📱 Mobile Friendly</li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 go.travel - Powered by Gemini AI Technology | Made with ❤️ for travelers</p>
            </div>
        </div>
    </footer>

    <!-- Floating Action Button -->
    <div class="fab" onclick="scrollToForm()" title="Start Planning">
        ✈️
    </div>

    <script>
        const CONFIG = {
            BACKEND_URL: 'http://localhost:5000'
        };

        // Global variables
        let map;
        let autocomplete;
        let currentItinerary = '';
        let currentDestination = '';

        // Initialize Google Maps and autocomplete
        function initMaps() {
            // Initialize autocomplete
            const destinationInput = document.getElementById('destination');
            if (destinationInput && google && google.maps && google.maps.places) {
                autocomplete = new google.maps.places.Autocomplete(destinationInput, {
                    types: ['(cities)'],
                    fields: ['place_id', 'name', 'formatted_address', 'geometry']
                });

                autocomplete.addListener('place_changed', function() {
                    const place = autocomplete.getPlace();
                    if (place.geometry) {
                        fetchLocationPreview(place.formatted_address);
                    }
                });
            }

            // Load popular destinations dynamically
            loadPopularDestinations();
        }

        // Check API status on page load
        document.addEventListener('DOMContentLoaded', function() {
            checkApiStatus();
            setupFormValidation();
            // Initialize maps if Google Maps API is already loaded
            if (typeof google !== 'undefined' && google.maps) {
                initMaps();
            }
        });

        async function checkApiStatus() {
            const backendStatus = document.getElementById('backend-status');
            const aiStatus = document.getElementById('ai-status');

            try {
                const response = await fetch(`${CONFIG.BACKEND_URL}/api/status`);
                if (response.ok) {
                    const data = await response.json();
                    
                    backendStatus.textContent = 'Online';
                    backendStatus.className = 'status-online';
                    
                    if (data.gemini_available && data.google_services_available) {
                        aiStatus.textContent = 'Enhanced AI Ready';
                        aiStatus.className = 'status-online';
                    } else if (data.gemini_available) {
                        aiStatus.textContent = 'Basic AI Ready';
                        aiStatus.className = 'status-warning';
                    } else {
                        aiStatus.textContent = 'Unavailable';
                        aiStatus.className = 'status-offline';
                    }
                    
                    // Log available services for debugging
                    console.log('Available APIs:', data.supported_apis || []);
                } else {
                    throw new Error('Backend not responding');
                }
            } catch (error) {
                backendStatus.textContent = 'Offline';
                backendStatus.className = 'status-offline';
                aiStatus.textContent = 'Unavailable';
                aiStatus.className = 'status-offline';
            }
        }

        function setupFormValidation() {
            const form = document.getElementById('tripForm');
            const startDate = document.getElementById('startDate');
            const endDate = document.getElementById('endDate');

            // Set minimum date to today
            const today = new Date().toISOString().split('T')[0];
            startDate.min = today;
            endDate.min = today;

            // Update end date minimum when start date changes
            startDate.addEventListener('change', function() {
                endDate.min = this.value;
                if (endDate.value && endDate.value < this.value) {
                    endDate.value = this.value;
                }
            });

            form.addEventListener('submit', handleFormSubmit);
            
            // Add location preview functionality
            const destinationInput = document.getElementById('destination');
            let locationTimeout;
            
            destinationInput.addEventListener('input', function() {
                clearTimeout(locationTimeout);
                const destination = this.value.trim();
                
                if (destination.length >= 3) {
                    locationTimeout = setTimeout(() => {
                        fetchLocationPreview(destination);
                    }, 1000); // Wait 1 second after user stops typing
                } else {
                    hideLocationPreview();
                }
                
                // Show recent searches if input is focused and has no value
                if (destination.length === 0) {
                    showRecentSearches();
                } else {
                    hideRecentSearches();
                }
            });

            destinationInput.addEventListener('focus', function() {
                if (this.value.trim().length === 0) {
                    showRecentSearches();
                }
            });

            destinationInput.addEventListener('blur', function() {
                // Delay hiding to allow clicking on recent searches
                setTimeout(() => {
                    hideRecentSearches();
                }, 200);
            });
        }

        async function fetchLocationPreview(destination) {
            const locationPreview = document.getElementById('location-preview');
            const locationBasic = document.getElementById('location-basic');
            const locationWeather = document.getElementById('location-weather');
            const locationTime = document.getElementById('location-time');
            const locationAttractions = document.getElementById('location-attractions');
            const locationRestaurants = document.getElementById('location-restaurants');
            const locationMapImg = document.getElementById('location-map-img');

            try {
                // Show loading state
                locationPreview.style.display = 'block';
                locationBasic.innerHTML = '<div style="color: var(--primary-blue);">🔍 Searching...</div>';
                locationWeather.innerHTML = '<div style="color: var(--primary-blue);">🔍 Loading weather...</div>';
                locationTime.innerHTML = '<div style="color: var(--primary-blue);">🔍 Getting time...</div>';
                locationAttractions.innerHTML = '<div style="color: var(--primary-blue);">🔍 Finding attractions...</div>';
                locationRestaurants.innerHTML = '<div style="color: var(--primary-blue);">🔍 Finding restaurants...</div>';

                // Fetch location information
                const response = await fetch(`${CONFIG.BACKEND_URL}/api/location-info`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ location: destination })
                });

                if (response.ok) {
                    const data = await response.json();
                    
                    if (data.error) {
                        showLocationError(data.error);
                        return;
                    }

                    // Update basic info
                    if (data.location) {
                        locationBasic.innerHTML = `
                            <div><strong>📍 Address:</strong><br>${data.location.address}</div>
                            <div style="margin-top: 0.5rem;"><strong>🌐 Coordinates:</strong><br>${data.location.coordinates.lat.toFixed(4)}, ${data.location.coordinates.lng.toFixed(4)}</div>
                        `;

                        // Generate static map
                        const mapResponse = await fetch(`${CONFIG.BACKEND_URL}/api/maps/static`, {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                            },
                            body: JSON.stringify({
                                center: `${data.location.coordinates.lat},${data.location.coordinates.lng}`,
                                zoom: 13,
                                size: '600x300',
                                markers: [`color:red|${data.location.coordinates.lat},${data.location.coordinates.lng}`]
                            })
                        });

                        if (mapResponse.ok) {
                            const mapData = await mapResponse.json();
                            // Create interactive map instead of static
                            createInteractiveMap(data.location.coordinates.lat, data.location.coordinates.lng, data.location.address);
                        } else {
                            // Fallback to interactive map without static URL
                            createInteractiveMap(data.location.coordinates.lat, data.location.coordinates.lng, data.location.address);
                        }
                    }

                    // Update weather info
                    if (data.weather && data.weather.main) {
                        const weather = data.weather;
                        locationWeather.innerHTML = `
                            <div><strong>🌡️ Temperature:</strong> ${weather.main.temp}°C</div>
                            <div><strong>🌤️ Condition:</strong> ${weather.weather[0].description}</div>
                            <div><strong>💨 Wind:</strong> ${weather.wind?.speed || 'N/A'} m/s</div>
                            <div><strong>💧 Humidity:</strong> ${weather.main.humidity}%</div>
                        `;
                    } else {
                        locationWeather.innerHTML = '<div style="color: var(--text-light);">Weather data unavailable</div>';
                    }

                    // Update timezone info
                    if (data.timezone && data.timezone.timeZoneId) {
                        try {
                            const now = new Date();
                            const timeZoneId = data.timezone.timeZoneId;
                            const localTime = now.toLocaleString('en-US', { 
                                timeZone: timeZoneId,
                                hour12: true,
                                hour: '2-digit',
                                minute: '2-digit',
                                second: '2-digit'
                            });
                            const localDate = now.toLocaleDateString('en-US', { 
                                timeZone: timeZoneId,
                                weekday: 'long',
                                year: 'numeric',
                                month: 'long',
                                day: 'numeric'
                            });
                            
                            locationTime.innerHTML = `
                                <div><strong>🕒 Local Time:</strong><br>${localTime}</div>
                                <div><strong>📅 Local Date:</strong><br>${localDate}</div>
                                <div><strong>🌍 Timezone:</strong><br>${data.timezone.timeZoneName || timeZoneId}</div>
                            `;
                        } catch (error) {
                            locationTime.innerHTML = `
                                <div><strong>🌍 Timezone:</strong><br>${data.timezone.timeZoneName || 'Unknown'}</div>
                                <div style="color: var(--text-light);">Local time calculation unavailable</div>
                            `;
                        }
                    } else {
                        locationTime.innerHTML = '<div style="color: var(--text-light);">Timezone data unavailable</div>';
                    }

                    // Update attractions
                    if (data.nearby && data.nearby.attractions && data.nearby.attractions.results) {
                        const attractions = data.nearby.attractions.results.slice(0, 5);
                        const attractionsList = attractions.map(place => 
                            `<div style="margin-bottom: 0.5rem;">🎯 ${place.name} (${place.rating ? place.rating + '⭐' : 'No rating'})</div>`
                        ).join('');
                        
                        locationAttractions.innerHTML = attractionsList || '<div style="color: var(--text-light);">No attractions found</div>';
                    } else {
                        locationAttractions.innerHTML = '<div style="color: var(--text-light);">No attractions found</div>';
                    }

                    // Update restaurants
                    if (data.nearby && data.nearby.restaurants && data.nearby.restaurants.results) {
                        const restaurants = data.nearby.restaurants.results.slice(0, 5);
                        const restaurantsList = restaurants.map(place => 
                            `<div style="margin-bottom: 0.5rem;">🍽️ ${place.name} (${place.rating ? place.rating + '⭐' : 'No rating'})</div>`
                        ).join('');
                        
                        locationRestaurants.innerHTML = restaurantsList || '<div style="color: var(--text-light);">No restaurants found</div>';
                    } else {
                        locationRestaurants.innerHTML = '<div style="color: var(--text-light);">No restaurants found</div>';
                    }

                } else {
                    showLocationError('Failed to fetch location information');
                }

            } catch (error) {
                console.error('Location preview error:', error);
                showLocationError('Error loading location information');
            }
        }

        function showLocationError(message) {
            const locationPreview = document.getElementById('location-preview');
            locationPreview.innerHTML = `
                <div style="color: var(--error); text-align: center; padding: 1rem;">
                    ❌ ${message}
                </div>
            `;
        }

        function hideLocationPreview() {
            const locationPreview = document.getElementById('location-preview');
            locationPreview.style.display = 'none';
        }

        async function handleFormSubmit(event) {
            event.preventDefault();
            
            const generateBtn = document.getElementById('generateBtn');
            const resultsSection = document.getElementById('resultsSection');
            const itineraryContent = document.getElementById('itineraryContent');
            const tripSummary = document.getElementById('tripSummary');

            // Prepare form data
            const formData = new FormData(event.target);
            const interests = Array.from(formData.getAll('interests'));
            
            const requestData = {
                destination: formData.get('destination'),
                start_date: formData.get('startDate'),
                end_date: formData.get('endDate'),
                duration: parseInt(formData.get('duration')),
                budget: formData.get('budget'),
                interests: interests,
                special_requests: formData.get('specialRequests')
            };

            // Save destination to recent searches
            saveToRecentSearches(requestData.destination);

            resultsSection.classList.add('show');
            itineraryContent.innerHTML = '<div class="loading"><div class="spinner"></div><span>Creating your perfect itinerary...</span></div>';

            try {
                const response = await fetch(`${CONFIG.BACKEND_URL}/api/generate-itinerary`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(requestData)
                });

                if (!response.ok) {
                    throw new Error(`Server error: ${response.status}`);
                }

                const data = await response.json();
                
                if (data.success) {
                    // Update trip summary
                    tripSummary.textContent = `${requestData.destination} • ${requestData.duration} days • ${new Date(requestData.start_date).toLocaleDateString()} to ${new Date(requestData.end_date).toLocaleDateString()}`;
                    
                    // Display itinerary
                    itineraryContent.innerHTML = formatItinerary(data.itinerary);
                    
                    // Show enhanced trip overview
                    await displayTripOverview(requestData.destination);
                    
                    // Show success message
                    showMessage('Itinerary generated successfully!', 'success');
                } else {
                    throw new Error(data.error || 'Failed to generate itinerary');
                }

            } catch (error) {
                console.error('Error:', error);
                itineraryContent.innerHTML = '';
                resultsSection.classList.remove('show');
                showMessage(`Error: ${error.message}. Please try again.`, 'error');
            }
        }

        async function displayTripOverview(destination) {
            const tripOverview = document.getElementById('trip-overview');
            const overviewLocation = document.getElementById('overview-location');
            const overviewWeather = document.getElementById('overview-weather');
            const overviewTransport = document.getElementById('overview-transport');
            const overviewTips = document.getElementById('overview-tips');

            try {
                // Show the overview section
                tripOverview.style.display = 'block';

                // Fetch comprehensive location data
                const response = await fetch(`${CONFIG.BACKEND_URL}/api/location-info`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ location: destination })
                });

                if (response.ok) {
                    const data = await response.json();
                    
                    // Location Details
                    if (data.location) {
                        overviewLocation.innerHTML = `
                            <div><strong>📍 Full Address:</strong><br>${data.location.address}</div>
                            <div style="margin-top: 0.5rem;"><strong>🌐 Coordinates:</strong><br>${data.location.coordinates.lat.toFixed(4)}°N, ${data.location.coordinates.lng.toFixed(4)}°E</div>
                        `;
                    }

                    // Weather Information
                    if (data.weather && data.weather.main) {
                        const weather = data.weather;
                        overviewWeather.innerHTML = `
                            <div><strong>🌡️ Current Temperature:</strong> ${weather.main.temp}°C (feels like ${weather.main.feels_like}°C)</div>
                            <div><strong>🌤️ Conditions:</strong> ${weather.weather[0].description}</div>
                            <div><strong>💨 Wind Speed:</strong> ${weather.wind?.speed || 'N/A'} m/s</div>
                            <div><strong>💧 Humidity:</strong> ${weather.main.humidity}%</div>
                            <div style="margin-top: 0.5rem; color: var(--primary-blue);"><em>💡 Plan outdoor activities accordingly!</em></div>
                        `;
                    } else {
                        overviewWeather.innerHTML = '<div>Weather data will be updated closer to your travel date.</div>';
                    }

                    // Transportation Tips
                    overviewTransport.innerHTML = `
                        <div><strong>🚗 Getting Around:</strong></div>
                        <div style="margin-top: 0.5rem;">
                            • Public transport and walking recommended<br>
                            • Consider ride-sharing apps for convenience<br>
                            • Check local transport passes for savings<br>
                            • Download offline maps before traveling
                        </div>
                    `;

                    // Local Tips
                    overviewTips.innerHTML = `
                        <div><strong>💡 Travel Smart:</strong></div>
                        <div style="margin-top: 0.5rem;">
                            • Book popular attractions in advance<br>
                            • Learn basic local phrases<br>
                            • Keep digital and physical copies of documents<br>
                            • Research local customs and etiquette<br>
                            • Have emergency contacts readily available
                        </div>
                    `;

                } else {
                    tripOverview.style.display = 'none';
                }

            } catch (error) {
                console.error('Trip overview error:', error);
                tripOverview.style.display = 'none';
            }
        }

        function formatItinerary(itinerary) {
            // Convert plain text itinerary to formatted HTML
            let formatted = itinerary
                .replace(/Day (\d+):/g, '<h3>📅 Day $1</h3>')
                .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                .replace(/\n\n/g, '</p><p>')
                .replace(/\n/g, '<br>');
            
            return `<div>${formatted}</div>`;
        }

        function showMessage(message, type) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `${type}-message`;
            messageDiv.textContent = message;
            
            const form = document.getElementById('tripForm');
            form.insertBefore(messageDiv, form.firstChild);
            
            // Remove message after 5 seconds
            setTimeout(() => {
                if (messageDiv.parentNode) {
                    messageDiv.parentNode.removeChild(messageDiv);
                }
            }, 5000);
        }

        // Auto-refresh status every 30 seconds
        setInterval(checkApiStatus, 30000);

        // Destination selection function
        function selectDestination(destination) {
            const destinationInput = document.getElementById('destination');
            destinationInput.value = destination;
            destinationInput.focus();
            
            // Save to recent searches
            saveToRecentSearches(destination);
            
            // Trigger location preview
            fetchLocationPreview(destination);
            
            // Smooth scroll to form
            document.getElementById('tripForm').scrollIntoView({ 
                behavior: 'smooth',
                block: 'start'
            });
        }

        // Recent searches functionality
        function getRecentSearches() {
            const searches = localStorage.getItem('recentSearches');
            return searches ? JSON.parse(searches) : [];
        }

        function saveToRecentSearches(destination) {
            let searches = getRecentSearches();
            
            // Remove if already exists
            searches = searches.filter(search => search !== destination);
            
            // Add to beginning
            searches.unshift(destination);
            
            // Keep only last 5 searches
            searches = searches.slice(0, 5);
            
            localStorage.setItem('recentSearches', JSON.stringify(searches));
        }

        function showRecentSearches() {
            const recentSearches = getRecentSearches();
            const recentSearchesDiv = document.getElementById('recent-searches');
            const recentSearchesList = document.getElementById('recent-searches-list');
            
            if (recentSearches.length === 0) {
                recentSearchesDiv.style.display = 'none';
                return;
            }

            const searchItems = recentSearches.map(search => 
                `<div class="recent-search-item" onclick="selectRecentSearch('${search}')">${search}</div>`
            ).join('');

            recentSearchesList.innerHTML = searchItems + 
                '<div class="clear-searches" onclick="clearRecentSearches()">Clear All</div>';
            
            recentSearchesDiv.style.display = 'block';
        }

        function hideRecentSearches() {
            document.getElementById('recent-searches').style.display = 'none';
        }

        function selectRecentSearch(destination) {
            const destinationInput = document.getElementById('destination');
            destinationInput.value = destination;
            hideRecentSearches();
            fetchLocationPreview(destination);
        }

        function clearRecentSearches() {
            localStorage.removeItem('recentSearches');
            hideRecentSearches();
        }

        // Initialize page when Google Maps API is ready
        function initializePage() {
            initializeAutocomplete();
            loadPopularDestinations();
        }

        // Initialize stats animation when page loads
        document.addEventListener('DOMContentLoaded', function() {
            // Stats animation removed - no longer using hardcoded statistics
        });

        // Initialize page features when Google Maps API is loaded
        window.addEventListener('load', function() {
            if (typeof google !== 'undefined') {
                initializePage();
            }
        });

        // Scroll to form function for FAB
        function scrollToForm() {
            document.getElementById('tripForm').scrollIntoView({ 
                behavior: 'smooth',
                block: 'start'
            });
        }

        // Create interactive map
        function createInteractiveMap(lat, lng, title) {
            const mapContainer = document.getElementById('location-map');
            if (!mapContainer || !google || !google.maps) return;

            const mapOptions = {
                center: { lat: lat, lng: lng },
                zoom: 13,
                mapTypeId: google.maps.MapTypeId.ROADMAP
            };

            map = new google.maps.Map(mapContainer, mapOptions);

            const marker = new google.maps.Marker({
                position: { lat: lat, lng: lng },
                map: map,
                title: title
            });

            const infoWindow = new google.maps.InfoWindow({
                content: `<div style="padding: 5px;"><strong>${title}</strong></div>`
            });

            marker.addListener('click', function() {
                infoWindow.open(map, marker);
            });
        }

        // Load popular destinations dynamically
        async function loadPopularDestinations() {
            const destinationGrid = document.getElementById('destination-grid');
            
            try {
                // Get trending destinations from a simple API or use a curated list
                const destinations = await fetchTrendingDestinations();
                
                const destinationCards = destinations.map(dest => `
                    <div class="destination-card" onclick="selectDestination('${dest.name}')">
                        <div class="destination-emoji">${dest.emoji}</div>
                        <h4>${dest.city}</h4>
                        <p>${dest.description}</p>
                    </div>
                `).join('');
                
                destinationGrid.innerHTML = destinationCards;
            } catch (error) {
                console.error('Error loading destinations:', error);
                // Fallback to minimal hardcoded list if API fails
                destinationGrid.innerHTML = `
                    <div class="destination-card" onclick="selectDestination('Paris, France')">
                        <div class="destination-emoji">🗼</div>
                        <h4>Paris</h4>
                        <p>City of Love</p>
                    </div>
                    <div class="destination-card" onclick="selectDestination('Tokyo, Japan')">
                        <div class="destination-emoji">🏯</div>
                        <h4>Tokyo</h4>
                        <p>Modern Culture</p>
                    </div>
                    <div class="destination-card" onclick="selectDestination('New York, USA')">
                        <div class="destination-emoji">🗽</div>
                        <h4>New York</h4>
                        <p>Big Apple</p>
                    </div>
                `;
            }
        }

        // Fetch trending destinations (you can integrate with a travel API)
        async function fetchTrendingDestinations() {
            // This could be integrated with a real travel API
            // For now, return a minimal dynamic list
            return [
                { name: 'Paris, France', city: 'Paris', emoji: '🗼', description: 'City of Love' },
                { name: 'Tokyo, Japan', city: 'Tokyo', emoji: '🏯', description: 'Modern Culture' },
                { name: 'New York, USA', city: 'New York', emoji: '🗽', description: 'Big Apple' },
                { name: 'London, England', city: 'London', emoji: '🏰', description: 'Royal Heritage' },
                { name: 'Rome, Italy', city: 'Rome', emoji: '🏛️', description: 'Eternal City' },
                { name: 'Sydney, Australia', city: 'Sydney', emoji: '🌉', description: 'Harbor City' }
            ];
        }

        // Clean itinerary formatting
        function formatItinerary(itinerary) {
            currentItinerary = itinerary;
            
            // Remove unwanted characters and format
            let formatted = itinerary
                .replace(/#{1,6}\s*/g, '') // Remove # characters
                .replace(/\*\*/g, '') // Remove ** characters
                .replace(/\*/g, '') // Remove * characters
                .replace(/Day (\d+):/g, '<h3>📅 Day $1</h3>')
                .replace(/\n\n/g, '</p><p>')
                .replace(/\n/g, '<br>');
            
            return `<div>${formatted}</div>`;
        }

        // Itinerary management functions
        async function refineItinerary() {
            const changes = document.getElementById('itinerary-changes').value.trim();
            if (!changes || !currentItinerary || !currentDestination) {
                alert('Please enter your requested changes.');
                return;
            }

            try {
                const response = await fetch(`${CONFIG.BACKEND_URL}/api/refine-itinerary`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        current_itinerary: currentItinerary,
                        feedback: changes,
                        destination: currentDestination
                    })
                });

                if (response.ok) {
                    const data = await response.json();
                    if (data.success) {
                        document.getElementById('itineraryContent').innerHTML = formatItinerary(data.itinerary);
                        document.getElementById('itinerary-changes').value = '';
                        showMessage('Itinerary updated successfully!', 'success');
                    } else {
                        throw new Error(data.error || 'Failed to refine itinerary');
                    }
                } else {
                    throw new Error('Server error');
                }
            } catch (error) {
                console.error('Error refining itinerary:', error);
                showMessage('Error updating itinerary. Please try again.', 'error');
            }
        }

        function shareItinerary() {
            if (!currentItinerary) return;
            
            if (navigator.share) {
                navigator.share({
                    title: `My ${currentDestination} Travel Itinerary`,
                    text: currentItinerary,
                    url: window.location.href
                });
            } else {
                // Fallback: copy to clipboard
                navigator.clipboard.writeText(currentItinerary).then(() => {
                    showMessage('Itinerary copied to clipboard!', 'success');
                });
            }
        }

        function downloadPDF() {
            if (!currentItinerary) return;
            
            // Create downloadable PDF (you might want to integrate with a PDF library)
            const element = document.createElement('a');
            const file = new Blob([currentItinerary], { type: 'text/plain' });
            element.href = URL.createObjectURL(file);
            element.download = `${currentDestination.replace(/[^a-z0-9]/gi, '_')}_itinerary.txt`;
            document.body.appendChild(element);
            element.click();
            document.body.removeChild(element);
        }

        function downloadText() {
            if (!currentItinerary) return;
            
            const element = document.createElement('a');
            const file = new Blob([currentItinerary], { type: 'text/plain' });
            element.href = URL.createObjectURL(file);
            element.download = `${currentDestination.replace(/[^a-z0-9]/gi, '_')}_itinerary.txt`;
            document.body.appendChild(element);
            element.click();
            document.body.removeChild(element);
        }

        function emailItinerary() {
            if (!currentItinerary) return;
            
            const subject = encodeURIComponent(`My ${currentDestination} Travel Itinerary`);
            const body = encodeURIComponent(currentItinerary);
            const mailtoLink = `mailto:?subject=${subject}&body=${body}`;
            window.open(mailtoLink);
        }
    </script>
</body>
</html>